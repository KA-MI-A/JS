<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用Atomics</title>
    <script>
        const sab = new SharedArrayBuffer(1024);
        const ta = new Uint8Array(sab);

        ta[0];
        // 0

        ta[0] = 5;
        // 5

        Atomics.add(ta, 0, 12);
        // 5
        Atomics.load(ta, 0);
        // 17 ✅
        // 12 ❌

        Atomics.and(ta, 0, 1);
        // 17
        Atomics.load(ta, 0);
        // 1

        Atomics.compareExchange(ta, 0, 5, 12);
        Atomics.load(ta, 0); // 12

        Atomics.exchange(ta, 0, 12);
        Atomics.load(ta, 0); // 12

        Atomics.isLockFree(1); // true
        Atomics.isLockFree(2); // true
        Atomics.isLockFree(3); // false
        Atomics.isLockFree(4); // true

        Atomics.or(ta, 0, 1);
        Atomics.load(ta, 0);  // 5

        Atomics.store(ta, 0, 12); // 12

        Atomics.sub(ta, 0, 2);
        Atomics.load(ta, 0); // 3

        Atomics.xor(ta, 0, 1);
        Atomics.load(ta, 0); // 4
    </script>
</head>

<body>

</body>

</html>